O(n+m+n+b+n)
