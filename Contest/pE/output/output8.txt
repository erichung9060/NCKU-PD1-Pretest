O(n+n+m+n+n)
